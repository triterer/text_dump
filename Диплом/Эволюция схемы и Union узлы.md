Эволюция схемы и Union узлы
========================

При добавлении в новых документов узлов к схеме, мы просто присоединяем новые узлы к схеме и записываем новые пути в KV хранилище. При этом с блокировками ничего делать не надо.

При удалении узлов из схемы вручную, можно удалять и все соответсвующие записи в KV хранилище через X блокировку. Поскольку блокировка эксклюзивная, то 

Единственный вариант изменения типа узла это изменение branch или leaf в union тип.

Есть ли у нас варианты автоматически удалять ветви?
Да, мы можем в Schema Registry хранить количество таких атрибутов в Schema Resistry. Надо будет только сделать блокировку на время декримента и инкремента. Если Schema Registry будет распределённым, то это будет болью в заднице синхрнизировать изменения в этом числе.

Есть ли у нас вариант автоматически откатывать union узлы в оставшееся представление?